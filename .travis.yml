language: generic 
# each time, we need super user permission
sudo: required
# we need a docker preinstalled
services:
  - docker

# series of steps before tests are run 
before_install:
  # to build docker image. The tag should be user/repo_name as common pratice. The tag is only used inside travis here
  - docker build -t docker-react -f Dockerfile.dev .
  # invalid argument "Shawn9999/docker-react" for "-t, --tag" flag: invalid reference format: repository name must be lowercase
script:
  # - docker run docker-react npm run test -- --coverage
  - docker run -e CI=true docker-react npm run test

deploy:
  provider: elasticbeanstalk 
    region: "us-east-1"
    app: "docker"
    env: "Docker-env"
    bucket_name: "....."
    bucket_path: "docker"
    on: 
      branch: master 

    access_key_id: $AWS_ACCESS_KEY
    secret_access_key: "$AWS_SECRET_KEY"
    